#! /usr/bin/python
"""
Schedules a job to reset individual counters of relayed mails to 0. This would make sure each spammer finds spamPot relaying everyday
"""
import datetime
import os
import time
import sys
import logging

from apscheduler.scheduler import Scheduler
import MySQLdb as mdb

import shivaconfig
import shivapushtodb

def resetcounter():
    logging.info("[+]ShivaScheduler Module: Try to push records in Db.")
    shivapushtodb.push()

def schedule():
    sched = Scheduler()
    sched.add_interval_job(resetcounter, minutes=60)
    sched.start()
    logging.info("spamPot spamScheduler started at %s (60 minutes interval). " % datetime.datetime.now())
