
#This file is no longer used in SHIVA.

import json
import requests
import logging
import datetime

def send(spam_id, subject, strippedText, originalText, ssdeepHash):
    try:
        logging.info("[+] In ShivaSolr Module")
        r = None
        url = "http://localhost:8983/solr/update?commit=true"
        payload = [{
          "id": str(datetime.datetime.now()),
          "md5": str(spam_id),
          "sub": str(subject),
          "stripped": str(strippedText),
          "original": str(originalText),
          "ssdeep" : str(ssdeepHash)
        }]
        headers = {"Content-Type": "application/json"}

        r = requests.post(url, data = json.dumps(payload), headers = headers)
        logging.info("Status code is %s" % r.status_code)
    except Exception, e:
        logging.critical("Error while sending data to Solr %s" % e)
        pass
